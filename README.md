# Godot AI Hook

[ç®€ä½“ä¸­æ–‡](README.md) | [English](README_EN.md)

## æ¦‚è¦ï¼šç”¨é€”ä¸ä¼˜ç‚¹

**Godot AI Hook** æ˜¯ä¸€ä¸ªé¢å‘ **Godot 4.5** çš„ AI èŠå¤©æ’ä»¶ï¼Œç”¨äºå¿«é€Ÿæ¥å…¥**å…¼å®¹ OpenAI Chat Completions åè®®**çš„æ¨¡å‹
ï¼ˆä¾‹å¦‚ï¼šéƒ¨åˆ†äº‘å‚å•†æä¾›çš„å…¼å®¹æ¥å£ï¼‰ã€‚

å¦‚æœä½ å¸Œæœ›æŠŠ **DeepSeekã€è±†åŒ…** è¿™ç±»å¤§æ¨¡å‹è½»æ¾æ¥è¿›æ¸¸æˆé‡Œï¼Œè®©ï¼š

* ä¸»è§’å’Œæ•Œäººå¯ä»¥å¯¹è¯
* NPC æ‹¥æœ‰â€œè‡ªå·±çš„æƒ³æ³•â€
* èƒŒæ™¯æ–‡æœ¬ã€æ—ç™½æ›´åŠ ç”ŸåŠ¨

é‚£è¿™ä¸ªæ’ä»¶å°±åƒä¸€ä¸ª **AI çš„é’©å­**ï¼Œç›´æ¥æŒ‚è½½åœ¨èŠ‚ç‚¹ä¸Šï¼Œç”¨èµ·æ¥ç®€å•ç›´è§‚ã€‚

---

## ğŸ“š ç›®å½•

- [Godot AI Hook](#godot-ai-hook)
  - [è®¾è®¡ç›®æ ‡](#è®¾è®¡ç›®æ ‡)
  - [ğŸ® ä½¿ç”¨åœºæ™¯è¯´æ˜ï¼ˆUse Casesï¼‰](#-ä½¿ç”¨åœºæ™¯è¯´æ˜use-cases)
  - [å®‰å…¨å£°æ˜ä¸å…è´£å£°æ˜](#å®‰å…¨å£°æ˜ä¸å…è´£å£°æ˜)
  - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
	- [æ ¸å¿ƒè„šæœ¬èŒè´£è¯´æ˜](#æ ¸å¿ƒè„šæœ¬èŒè´£è¯´æ˜)
	  - [AiManage](#aimanage)
	  - [ChatNode](#chatnode)
	  - [ChatStreamNode](#chatstreamnode)
	  - [æµ‹è¯•é¢æ¿ï¼ˆtestï¼‰](#æµ‹è¯•é¢æ¿test)
  - [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
	- [1. å®‰è£…æ’ä»¶](#1-å®‰è£…æ’ä»¶)
	- [2. é…ç½®æ¨¡å‹ä¿¡æ¯](#2-é…ç½®æ¨¡å‹ä¿¡æ¯)
	- [3. æµ‹è¯•æ¨¡å‹è¿æ¥](#3-æµ‹è¯•æ¨¡å‹è¿æ¥)
	- [4. ä½¿ç”¨ Godot AI Hook](#4-ä½¿ç”¨-godot-ai-hook)
	- [5. ä½¿ç”¨è‡ªå®šä¹‰ System Prompt](#5-ä½¿ç”¨è‡ªå®šä¹‰-system-prompt)
	- [6. å°†æµå¼èŠ‚ç‚¹æ”¹ä¸ºéæµå¼èŠ‚ç‚¹](#6-å°†æµå¼èŠ‚ç‚¹æ”¹ä¸ºéæµå¼èŠ‚ç‚¹)


---
> **Godot AI Hook çš„ç›®æ ‡æ˜¯ï¼š
> æŠŠ AI å˜æˆä¸€ä¸ªä½ ç†Ÿæ‚‰çš„ Godot èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯å¤–éƒ¨ SDKã€‚**

* Node-firstï¼šAI æ˜¯èŠ‚ç‚¹ï¼Œå¯ç›´æ¥æŒ‚è½½ä¸è°ƒç”¨
* Unified APIï¼šæµå¼ / éæµå¼ç»Ÿä¸€å…¥å£
* Client-sideï¼šä¸ç»‘å®šæ¨¡å‹æˆ–å‚å•†
* Defensiveï¼šæ˜ç¡®å¤±è´¥ï¼Œä¸åšé»‘é­”æ³•

---

## ğŸ® ä½¿ç”¨åœºæ™¯è¯´æ˜ï¼ˆUse Casesï¼‰

ä»¥ä¸‹æ˜¯ Godot AI Hook **éå¸¸é€‚åˆ** çš„å…¸å‹åœºæ™¯ï¼š

---

### ğŸ§™ NPC å¯¹è¯ä¸æ€§æ ¼é©±åŠ¨

* æ¯ä¸ª NPC ä½¿ç”¨ä¸åŒçš„ System Prompt
* å³æ—¶ç”Ÿæˆå¯¹è¯å†…å®¹
* è®© NPC ä¸å†åªæ˜¯â€œé€‰é¡¹æ ‘â€


---

### ğŸ“œ å‰§æƒ…æ—ç™½ / ä¸–ç•Œè§‚æ–‡æœ¬ç”Ÿæˆ

* æµå¼è¾“å‡ºéå¸¸é€‚åˆï¼š

  * å‰§æƒ…å­—å¹•
  * ä¸–ç•Œè§‚ä»‹ç»
  * å›å¿†ã€ç‹¬ç™½

æ­é…æ‰“å­—æœºæ•ˆæœï¼Œå¯ä»¥æ˜¾è‘—æå‡æ²‰æµ¸æ„Ÿã€‚

---

### ğŸ§ª åŸå‹éªŒè¯ & ç©æ³•å®éªŒ

åœ¨åŸå‹é˜¶æ®µï¼Œä½ å¯ä»¥ï¼š

* ä¸å†™å®Œæ•´å‰§æƒ…
* ä¸è®¾è®¡å¤æ‚å¯¹è¯æ ‘
* ç”¨ AI å¿«é€ŸéªŒè¯ç©æ³•æ„Ÿè§‰

---

### ğŸ¤– æ¸¸æˆå†… AI åŠ©æ‰‹ / å¼•å¯¼è§’è‰²

* æ–°æ‰‹æ•™ç¨‹åŠ©æ‰‹
* ç³»ç»Ÿæç¤ºè§’è‰²
* â€œç¬¬å››é¢å¢™å¤–â€çš„è§£é‡Šè€…

---

### ğŸ› ï¸ éæ­£å¼ç”¨é€”ï¼ˆå·¥å…· / å®éªŒï¼‰

è™½ç„¶æ˜¯æ¸¸æˆæ’ä»¶ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨äºï¼š

* Godot å†…éƒ¨å·¥å…· AI
* æ–‡æœ¬ç”Ÿæˆæµ‹è¯•
* AI è¡Œä¸ºå®éªŒ

---

## âœ¨ ä¸€å¥è¯æ€»ç»“è®¾è®¡ç†å¿µ

> **Godot AI Hook ä¸è¯•å›¾æ•™ä½ â€œå¦‚ä½•ä½¿ç”¨ AIâ€ï¼Œ
> å®ƒåªè´Ÿè´£æŠŠ AIï¼Œå˜æˆä¸€ä¸ªä½ ç†Ÿæ‚‰çš„ Godot èŠ‚ç‚¹ã€‚**


> **æç¤º**
> å¤§å¤šæ•°æ¨¡å‹æœåŠ¡å•†éƒ½æä¾› OpenAI å…¼å®¹æ¥å£ï¼Œæœ¬æ’ä»¶å·²å°½é‡é€‚é…ã€‚
> ä½†ç”±äºå„å®¶åœ¨è¾“å…¥è¾“å‡ºç»†èŠ‚ä¸Šçš„å·®å¼‚ï¼Œä¸ªåˆ«æ¨¡å‹å¯èƒ½æ— æ³•æ­£å¸¸è¿æ¥ï¼Œæ•¬è¯·ç†è§£ã€‚

---

## å®‰å…¨å£°æ˜ä¸å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…å®ç° **AI è°ƒç”¨é€»è¾‘**ï¼Œä¸»è¦ç”¨äº**ä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œå¨±ä¹å®éªŒ**ï¼Œ
**æœªé’ˆå¯¹å®‰å…¨ä¸åˆè§„åœºæ™¯è¿›è¡Œç³»ç»Ÿæ€§è®¾è®¡**ã€‚åœ¨ä½¿ç”¨æ—¶è¯·è‡ªè¡Œåšå¥½é£é™©è¯„ä¼°ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

* å¦¥å–„ä¿ç®¡ API Keyï¼Œä¸è¦å°†çœŸå®å¯†é’¥æäº¤åˆ°å…¬å¼€ä»“åº“æˆ–æˆªå›¾ä¸­æ³„éœ²ï¼›
* åˆç†è®¾ç½®è°ƒç”¨é¢‘ç‡ä¸é…é¢ï¼Œé¿å…æ¥å£æ»¥ç”¨æˆ–è§¦å‘æœåŠ¡å•†é£æ§ï¼›
* æ ¹æ®ä¸šåŠ¡åœºæ™¯å¯¹ AI è¾“å‡ºè¿›è¡Œå®¡æ ¸ä¸è¿‡æ»¤ï¼Œé¿å…ç›´æ¥ä½œä¸ºæœ€ç»ˆå†³ç­–ä¾æ®ã€‚

æœ¬é¡¹ç›®ä»…ä½œä¸º AI æœåŠ¡è°ƒç”¨çš„å®¢æˆ·ç«¯å°è£…ï¼Œ**ä¸å¯¹æ¨¡å‹ç”Ÿæˆå†…å®¹æ‰¿æ‹…ä»»ä½•è´£ä»»**ã€‚
è¯·åœ¨éµå®ˆæ‰€åœ¨åœ°åŒºæ³•å¾‹æ³•è§„åŠæ¨¡å‹æœåŠ¡å•†ä½¿ç”¨æ¡æ¬¾çš„å‰æä¸‹åˆç†ä½¿ç”¨ã€‚

ä½œè€…èƒ½åŠ›æœ‰é™ï¼Œå¦‚æœ‰è®¾è®¡æˆ–å®ç°ä¸å½“ä¹‹å¤„ï¼Œæ¬¢è¿ï¼š

* æ Issue
* æ PR
* Fork æœ¬ä»“åº“ä¸€èµ·æ”¹è¿›

---

## é¡¹ç›®ç»“æ„

```text
addons/
â””â”€ godot_ai_hook/
   â”œâ”€ plugin.cfg                  # Godot æ’ä»¶é…ç½®ï¼ˆåç§°ã€æè¿°ã€å…¥å£è„šæœ¬ï¼‰
   â”œâ”€ plugin.gd                   # EditorPluginï¼šæ³¨å†Œèœå•ã€æ‰“å¼€æµ‹è¯•é¢æ¿ä¸é…ç½®è„šæœ¬
   â”‚
   â”œâ”€ ai_config.gd                # æ¨¡å‹åŸºç¡€é…ç½®ï¼ˆurl / api_key / model / portï¼‰
   â”œâ”€ system_prompt_config.gd     # System Prompt é…ç½®å­—å…¸ï¼ˆæŒ‰ key ç®¡ç†ï¼‰
   â”‚
   â”œâ”€ ai_manage/
   â”‚  â”œâ”€ ai_manage.gd             # AiManage æ ¸å¿ƒç®¡ç†èŠ‚ç‚¹ï¼ˆç»Ÿä¸€å…¥å£ï¼‰
   â”‚  â””â”€ ai_manage.tscn           # AiManage åœºæ™¯
   â”‚
   â”œâ”€ chat_node/
   â”‚  â”œâ”€ chat_node.gd             # éæµå¼å®ç°ï¼šHTTPRequest + å•æ¬¡ JSON å“åº”
   â”‚  â””â”€ chat_node.tscn           # ChatNode åœºæ™¯
   â”‚
   â”œâ”€ chat_stream_node/
   â”‚  â”œâ”€ chat_stream_node.gd      # æµå¼å®ç°ï¼šHTTPClient + SSE æ–‡æœ¬æµ
   â”‚  â””â”€ chat_stream_node.tscn    # ChatStreamNode åœºæ™¯
   â”‚
   â””â”€ test/
	  â”œâ”€ test.gd                  # æµ‹è¯•é¢æ¿è„šæœ¬ï¼ˆè¿æ¥æµ‹è¯• + æ•ˆæœæµ‹è¯•ï¼‰
	  â””â”€ test.tscn                # æµ‹è¯•é¢æ¿åœºæ™¯
```

### æ ¸å¿ƒè„šæœ¬èŒè´£è¯´æ˜

#### AiManage

* é‡è¦å¯¹å¤–æ¥å£ï¼š

  * `say(content, system_prompt)`
  * `say_bind_key(content, key)`
  * `set_ai_stream_type(is_true)`


#### ChatNode

* ä½¿ç”¨ `HTTPRequest` å‘é€ä¸€æ¬¡æ€§è¯·æ±‚
* è§£æå®Œæ•´ JSON å“åº”
* å‡ºé”™æ—¶é€šè¿‡ `parent.on_ai_error_occurred()` å›è°ƒ

#### ChatStreamNode

* ä½¿ç”¨ `HTTPClient` å»ºç«‹ HTTPS è¿æ¥
* å‘é€ `stream: true` çš„è¯·æ±‚
* è§£æä»¥ `data:` å¼€å¤´çš„ SSE æ–‡æœ¬æµ
* è¯†åˆ« `[DONE]` ç»“æŸæ ‡è®°
* é€šè¿‡ä»¥ä¸‹å›è°ƒæ¨é€å¢é‡å†…å®¹ï¼š

  * `on_ai_reasoning_content_generated`
  * `on_ai_content_generated`

#### æµ‹è¯•é¢æ¿ï¼ˆtestï¼‰

* æä¾› UI ç”¨äºå¿«é€Ÿæµ‹è¯• API è¿æ¥ä¸å±•ç¤ºæ•ˆæœ
* åŒ…å«ä¸­æ–­é•¿æ–‡æœ¬ç”Ÿæˆçš„å®éªŒé€»è¾‘

---

## ä½¿ç”¨æ–¹æ³•

### 1. å®‰è£…æ’ä»¶

æ‰“å¼€æ’ä»¶å¸‚åœºæœç´¢ä¸‹è½½æ’ä»¶

![install](https://github.com/3301712806/godot_ai_hook/blob/main/image/install.jpg?raw=true)

å°† `godot_ai_hook` æ–‡ä»¶å¤¹å¤åˆ¶åˆ°é¡¹ç›®çš„ `addons` ç›®å½•ä¸­ã€‚
ç„¶ååœ¨ï¼š

**èœå•æ  â†’ é¡¹ç›® â†’ é¡¹ç›®è®¾ç½® â†’ æ’ä»¶**

ä¸­å¯ç”¨æ’ä»¶ã€‚

---

### 2. é…ç½®æ¨¡å‹ä¿¡æ¯

åœ¨ **èœå•æ  â†’ é¡¹ç›® â†’ å·¥å…·** ä¸­å¯ä»¥çœ‹åˆ° **AI Hook** ç›¸å…³é€‰é¡¹ã€‚

![show\_config](https://github.com/3301712806/godot_ai_hook/blob/main/image/config.jpg?raw=true)

ç‚¹å‡» **AI Hookï¼šOpen Model Config Script**ï¼Œæ ¹æ®æ‰€ä½¿ç”¨æ¨¡å‹æœåŠ¡å•†çš„æ–‡æ¡£å¡«å†™é…ç½®ã€‚

![config\_ai](https://github.com/user-attachments/assets/7b94231e-50de-4797-a590-8fc0c7e21cbd)

---

### 3. æµ‹è¯•æ¨¡å‹è¿æ¥

ç‚¹å‡» **AI Hookï¼šOpen Test Panel**ï¼Œè¿›å…¥æµ‹è¯•åœºæ™¯å¹¶è¿è¡Œã€‚

![open\_test](https://github.com/user-attachments/assets/75117546-b25c-499d-8e0e-c2ef55a26846)

è¿æ¥æˆåŠŸç¤ºä¾‹ï¼š

![test](https://github.com/user-attachments/assets/431d6c29-2927-41fb-af11-f4c04cd686d2)

---

### 4. ä½¿ç”¨ Godot AI Hook

åœ¨åœºæ™¯ä¸­é€‰æ‹©ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œåœ¨å…¶ä¸‹æŒ‚è½½ä¸€ä¸ª `ai_manage` èŠ‚ç‚¹
ï¼ˆ`Ctrl + A` æœç´¢ `ai_manage` å³å¯ï¼‰ã€‚

![load\_ai\_manage](https://github.com/user-attachments/assets/e15d6fcd-dbd6-47ce-8ee7-6dead78bbfd0)

åœ¨è„šæœ¬ä¸­å¼•ç”¨è¯¥èŠ‚ç‚¹å¹¶è°ƒç”¨ï¼š

```gdscript
ai_manage.say("ä½ æƒ³é—®çš„é—®é¢˜")
```

è¿è¡Œåœºæ™¯å³å¯çœ‹åˆ° AI å›å¤ã€‚

![excute](https://github.com/user-attachments/assets/844156d8-e82f-46c7-82b2-eab4703cb579)
![it\_work!](https://github.com/user-attachments/assets/bbb93514-873c-429c-aa9f-309a4ef202af)

---

### 5. ä½¿ç”¨è‡ªå®šä¹‰ System Prompt

è™½ç„¶å¯ä»¥ç›´æ¥ä¼ å…¥ `system_prompt`ï¼š

```gdscript
ai_manage.say("é—®é¢˜å†…å®¹", system_prompt)
```

ä½† System Prompt é€šå¸¸è¾ƒé•¿ï¼Œ**æ›´æ¨èä½¿ç”¨é…ç½®æ–‡ä»¶ + key çš„æ–¹å¼**ã€‚

åœ¨ **èœå•æ  â†’ é¡¹ç›® â†’ å·¥å…· â†’ AI Hookï¼šOpen System Prompt Script** ä¸­é…ç½®ï¼š

![system\_prompt](https://github.com/user-attachments/assets/ba27dd85-aab4-4106-8282-54c9aca126ed)

ç¤ºä¾‹è°ƒç”¨ï¼š

```gdscript
ai_manage.say_bind_key("ä½ å¥½å•Šï¼Œdeepseek", "å‹æƒ…çŒ«å¨˜")
```

å°±åƒä¸€ä¸ªâ€œçŒ«å¨˜ AI é’©å­â€æŒ‚åœ¨èŠ‚ç‚¹ä¸Šä¸€æ · ğŸ±

![it\_work\_again](https://github.com/user-attachments/assets/84d89bc2-e188-40e6-af84-abbc73b6a558)

---

### 6. å°†æµå¼èŠ‚ç‚¹æ”¹ä¸ºéæµå¼èŠ‚ç‚¹
 

ç¤ºä¾‹è°ƒç”¨ï¼š

```gdscript
ai_manage.set_ai_stream_type(true)#è®¾ä¸ºæµå¼
ai_manage.set_ai_stream_type(false)#è®¾ä¸ºéæµå¼

```

## æ”¯æŒä¸ Star â­

å¦‚æœè¿™ä¸ªæ’ä»¶å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæˆ–è€…åœ¨ä½ çš„é¡¹ç›®ä¸­å“ªæ€•åªå‘æŒ¥äº†ä¸€ç‚¹ç‚¹ä½œç”¨ï¼Œ
æ¬¢è¿åœ¨ GitHub ä¸Šç‚¹ä¸€ä¸ª **Star** â­ã€‚

ä½ çš„æ”¯æŒæ˜¯ä½œè€…æŒç»­ç»´æŠ¤ã€ä¿®å¤é—®é¢˜å¹¶å°è¯•åŠ å…¥æ›´å¤šæœ‰è¶£åŠŸèƒ½çš„æœ€å¤§åŠ¨åŠ› â¤ï¸

---
